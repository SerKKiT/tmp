<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# üé¨ StreamApp - Live Video Streaming Platform

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è live –≤–∏–¥–µ–æ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π SRT –≤—Ö–æ–¥—è—â–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ –∏ HLS –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ Go —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–µ–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º CI/CD —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏](#-%D0%BE%D1%81%D0%BE%D0%B1%D0%B5%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D0%B8)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#-%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#-%D1%82%D1%80%D0%B5%D0%B1%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-%D0%B1%D1%8B%D1%81%D1%82%D1%80%D1%8B%D0%B9-%D1%81%D1%82%D0%B0%D1%80%D1%82)
- [API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#-api-%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D1%8F)
- [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#-%D1%80%D0%B0%D0%B7%D0%B2%D0%B5%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#-%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D1%8C)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#-%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3)
- [Troubleshooting](#-troubleshooting)


## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### **Streaming –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

- üì° **SRT –ø—Ä–∏–µ–º** - –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—Ö–æ–¥—è—â–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è —Å—Ç—Ä–∏–º–æ–≤
- üé• **HLS –¥–æ—Å—Ç–∞–≤–∫–∞** - –ø–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- üîÑ **Real-time –ø–µ—Ä–µ–ø–∞–∫–æ–≤–∫–∞** - –±–µ–∑ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞)
- üìä **Live –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Ç–æ–∫–æ–≤
- ‚ö° **–ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** - —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–±–æ—è–º —Å–µ—Ç–∏


### **API –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**

- üåê **RESTful API** - –ø–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞–º–∏
- üéØ **HLS Metadata API** - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π endpoint –¥–ª—è –≤–∏–¥–µ–æ –ø–ª–µ–µ—Ä–æ–≤
- üîê **Token –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É
- üåç **CORS –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
- üì± **Responsive UI** - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è


### **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

- üê≥ **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** - –ª–µ–≥–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- üîí **HTTPS –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- üîÑ **CI/CD –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - GitLab pipelines
- üìà **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –Ω–∞–≥—Ä—É–∑–∫–µ
- üíæ **PostgreSQL** - –Ω–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö


## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Client App    ‚îÇ    ‚îÇ   Web Browser   ‚îÇ    ‚îÇ  Mobile App     ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ                      ‚îÇ                      ‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ HTTPS/443
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ       nginx             ‚îÇ
                    ‚îÇ   (Reverse Proxy)       ‚îÇ
                    ‚îÇ   SSL Termination       ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ             ‚îÇ
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ   go-app      ‚îÇ   ‚îÇ streaming-      ‚îÇ
                ‚îÇ   :8080       ‚îÇ   ‚îÇ service :8081   ‚îÇ
                ‚îÇ               ‚îÇ   ‚îÇ                 ‚îÇ
                ‚îÇ ‚Ä¢ Tasks API   ‚îÇ   ‚îÇ ‚Ä¢ Stream API    ‚îÇ
                ‚îÇ ‚Ä¢ Web UI      ‚îÇ   ‚îÇ ‚Ä¢ HLS API       ‚îÇ
                ‚îÇ ‚Ä¢ Health      ‚îÇ   ‚îÇ ‚Ä¢ FFmpeg Mgmt   ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ                     ‚îÇ
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                   ‚îÇ
                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                        ‚îÇ    PostgreSQL       ‚îÇ
                        ‚îÇ     :5432           ‚îÇ
                        ‚îÇ                     ‚îÇ
                        ‚îÇ ‚Ä¢ Tasks            ‚îÇ
                        ‚îÇ ‚Ä¢ Streams          ‚îÇ
                        ‚îÇ ‚Ä¢ Metadata         ‚îÇ
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ         External Components          ‚îÇ
              ‚îÇ                                     ‚îÇ
              ‚îÇ  SRT Input  ‚Üí  FFmpeg  ‚Üí  HLS Files ‚îÇ
              ‚îÇ  :10000+        Process      /hls/  ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```


### **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü–æ—Ä—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| :-- | :-- | :-- |
| **nginx** | 80, 443 | Reverse proxy, SSL termination, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã |
| **go-app** | 8080 | –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ |
| **streaming-service** | 8081 | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞–º–∏, FFmpeg, HLS API |
| **PostgreSQL** | 5432 | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| **FFmpeg** | 10000+ | SRT –ø—Ä–∏–µ–º –∏ HLS –≥–µ–Ω–µ—Ä–∞—Ü–∏—è |

## üõ†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

- **OS:** Linux (Ubuntu 20.04+, CentOS 8+, Debian 11+)
- **CPU:** 2+ cores, x64 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **RAM:** 4GB+ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8GB –¥–ª—è production)
- **Storage:** 20GB+ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- **Network:** –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ


### **–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ:**

- **Docker:** 24.0+
- **Docker Compose:** 2.0+
- **Git:** –î–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- **OpenSSL:** –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤


### **–°–µ—Ç–µ–≤—ã–µ –ø–æ—Ä—Ç—ã:**

- **80** - HTTP (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ HTTPS)
- **443** - HTTPS (–æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ—Å—Ç—É–ø)
- **8080** - go-app (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)
- **8081** - streaming-service (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)
- **5432** - PostgreSQL (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)
- **10000-10100** - SRT –≤—Ö–æ–¥—è—â–∏–µ –ø–æ—Ç–æ–∫–∏


## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### **1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**

```bash
git clone https://github.com/your-org/streamapp.git
cd streamapp
```


### **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª
cp deployments/.env.production.template deployments/.env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
nano deployments/.env
```

**–ü—Ä–∏–º–µ—Ä `.env` —Ñ–∞–π–ª–∞:**

```env
# Database Configuration
DB_HOST=postgres
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=your_secure_password
DB_NAME=streamapp
DB_SSLMODE=disable

# Application Configuration  
STREAMING_SERVICE_URL=http://streaming-service:8081
SERVER_IP=192.168.1.100
ENVIRONMENT=production

# Security
STREAM_TOKEN_SECRET=your_secret_key_change_in_production
CDN_DOMAIN=your-domain.com
```


### **3. SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:**

**–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π):**

```bash
mkdir -p nginx/ssl
openssl req -x509 -newkey rsa:4096 -nodes \
  -keyout nginx/ssl/server.key \
  -out nginx/ssl/server.crt \
  -days 365 \
  -subj "/C=RU/ST=State/L=City/O=StreamApp/CN=your-domain.com" \
  -addext "subjectAltName=IP:192.168.1.100,DNS:your-domain.com"

chmod 600 nginx/ssl/server.key
chmod 644 nginx/ssl/server.crt
```

**–î–ª—è production (Let's Encrypt):**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ certbot
sudo apt install certbot

# –ü–æ–ª—É—á–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
sudo certbot certonly --standalone -d your-domain.com

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
sudo cp /etc/letsencrypt/live/your-domain.com/fullchain.pem nginx/ssl/server.crt
sudo cp /etc/letsencrypt/live/your-domain.com/privkey.pem nginx/ssl/server.key
```


### **4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**

```bash
cd deployments

# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f
```


### **5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl -k https://your-domain.com/api/tasks

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
# –û—Ç–∫—Ä–æ–π—Ç–µ https://your-domain.com –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```


## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### **–û—Å–Ω–æ–≤–Ω—ã–µ endpoints:**

#### **üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏:**

```http
# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
GET /api/tasks
Accept: application/json

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
POST /api/tasks
Content-Type: application/json
{
  "name": "Live Stream 1",
  "stream_id": "unique-stream-id"
}
```


#### **üé• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞–º–∏:**

```http
# –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
GET /api/streams
Accept: application/json

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Ç–æ–∫–µ
GET /api/streams/{stream_id}
Accept: application/json

# –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞
POST /api/streams
Content-Type: application/json
{
  "stream_id": "unique-stream-id",
  "action": "start"
}

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Ç–æ–∫–∞  
POST /api/streams
Content-Type: application/json
{
  "stream_id": "unique-stream-id",
  "action": "stop"
}
```


#### **üì∫ HLS Metadata API:**

```http
# –ü–æ–ª—É—á–∏—Ç—å HLS –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
GET /api/hls/{stream_id}
Accept: application/json

# –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
{
  "message": "HLS stream metadata",
  "stream_id": "unique-stream-id",
  "status": "running",
  "data": {
    "hls_url": "https://your-domain.com/hls/unique-stream-id/playlist.m3u8",
    "stream_url": "https://your-domain.com/hls/unique-stream-id/playlist.m3u8?token=abc123",
    "access_token": "abc123def456",
    "cdn_domain": "your-domain.com",
    "is_live": true,
    "start_time": "2025-09-03T00:00:00Z"
  }
}
```


#### **üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**

```http
# Health check –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
GET /api/health

# Health check streaming —Å–µ—Ä–≤–∏—Å–∞  
GET /streaming/api/health

# Debug –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–ª–µ–π–ª–∏—Å—Ç–µ
GET /api/debug/{stream_id}
```


### **–°—Ç–∞—Ç—É—Å—ã –ø–æ—Ç–æ–∫–æ–≤:**

- **`starting`** - –ø–æ—Ç–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è, –æ–∂–∏–¥–∞–µ—Ç SRT –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- **`running`** - –∞–∫—Ç–∏–≤–Ω–∞—è —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è HLS —Å–µ–≥–º–µ–Ω—Ç—ã
- **`stopped`** - –ø–æ—Ç–æ–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- **`error`** - –æ—à–∏–±–∫–∞ –≤ —Ä–∞–±–æ—Ç–µ –ø–æ—Ç–æ–∫–∞


## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### **nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

–û—Å–Ω–æ–≤–Ω—ã–µ location –±–ª–æ–∫–∏ –≤ `nginx/nginx.conf`:

```nginx
# –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∑–∞–¥–∞—á–∏)
location / {
    proxy_pass http://go_app;
}

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞–º–∏  
location /api/streams {
    proxy_pass http://streaming_service;
}

# HLS –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–ª–µ–µ—Ä–æ–≤
location /api/hls/ {
    proxy_pass http://streaming_service;
}

# HLS —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
location /hls/ {
    alias /opt/streamapp/hls_output/;
}
```


### **Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

`deployments/docker-compose.yml` —Å–æ–¥–µ—Ä–∂–∏—Ç:

- Multi-stage —Å–±–æ—Ä–∫—É Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—ã –Ω–∞ Alpine Linux
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- Health checks –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- Persistent volumes –¥–ª—è –¥–∞–Ω–Ω—ã—Ö


### **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| :-- | :-- | :-- |
| `DB_HOST` | –•–æ—Å—Ç PostgreSQL | `postgres` |
| `DB_PASSWORD` | –ü–∞—Ä–æ–ª—å –ë–î | `mypassword123` |
| `SERVER_IP` | IP —Å–µ—Ä–≤–µ—Ä–∞ | `localhost` |
| `CDN_DOMAIN` | –î–æ–º–µ–Ω –¥–ª—è HLS URLs | `SERVER_IP` |
| `STREAM_TOKEN_SECRET` | –ö–ª—é—á –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ | `default-secret` |

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### **Production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:**

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker
sudo usermod -aG docker $USER
```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall:**
```bash
# UFW
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp  
sudo ufw allow 443/tcp
sudo ufw allow 10000:10100/udp
sudo ufw --force enable

# –ò–ª–∏ iptables
sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT  
sudo iptables -A INPUT -p udp --dport 10000:10100 -j ACCEPT
```

3. **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è production:**
```bash
# Let's Encrypt –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
echo "0 12 * * * /usr/bin/certbot renew --quiet" | sudo crontab -
```


### **GitLab CI/CD:**

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ —á–µ—Ä–µ–∑ `.gitlab-ci.yml`:

**–≠—Ç–∞–ø—ã pipeline:**

1. **Build** - —Å–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤
2. **Deploy:staging** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π deploy –Ω–∞ staging
3. **Test** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. **Deploy:production** - —Ä—É—á–Ω–æ–π deploy –Ω–∞ production

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ GitLab:**

```
Settings ‚Üí CI/CD ‚Üí Variables:
- SSH_PRIVATE_KEY: SSH –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä–∞–º
- STAGING_SERVER: IP staging —Å–µ—Ä–≤–µ—Ä–∞  
- STAGING_USER: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ staging —Å–µ—Ä–≤–µ—Ä–µ
- PRODUCTION_SERVER: IP production —Å–µ—Ä–≤–µ—Ä–∞
- PRODUCTION_USER: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ production —Å–µ—Ä–≤–µ—Ä–µ
```


## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### **SSL/TLS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP ‚Üí HTTPS
- TLS 1.2+ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ cipher suites
- HSTS headers –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤


### **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è API:**

- Token-based –¥–æ—Å—Ç—É–ø –∫ HLS –∫–æ–Ω—Ç–µ–Ω—Ç—É
- SHA256 –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö URL
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º


### **–°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**

- Firewall –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- Internal Docker networks
- Nginx rate limiting (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)


### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```bash
# –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
DB_PASSWORD=secure_random_password_123

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–π secret key
STREAM_TOKEN_SECRET=cryptographically_secure_random_key

# –û–±–Ω–æ–≤–ª—è–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
# Let's Encrypt –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 90 –¥–Ω–µ–π
```


## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **Health Checks:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
curl -k https://your-domain.com/api/health

# Streaming service health  
curl -k https://your-domain.com/streaming/api/health

# Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose ps
```


### **–õ–æ–≥–∏:**

```bash
# –í—Å–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose logs -f

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
docker-compose logs -f go-app
docker-compose logs -f streaming-service
docker-compose logs -f nginx

# FFmpeg –ª–æ–≥–∏ –ø–æ—Ç–æ–∫–æ–≤
tail -f /opt/streamapp/logs/stream-id.log
```


### **–ú–µ—Ç—Ä–∏–∫–∏:**

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è:

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
- –°—Ç–∞—Ç—É—Å—ã –ø–æ—Ç–æ–∫–æ–≤ (starting/running/stopped)
- HLS –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–Ω–æ–≤—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã)
- –°–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –û—à–∏–±–∫–∏ FFmpeg –ø—Ä–æ—Ü–µ—Å—Å–æ–≤


## üîß Troubleshooting

### **–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

**1. Nginx –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (SSL –æ—à–∏–±–∫–∏):**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
openssl x509 -in nginx/ssl/server.crt -text -noout
openssl rsa -in nginx/ssl/server.key -check -noout

# –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞  
chmod 600 nginx/ssl/server.key
chmod 644 nginx/ssl/server.crt

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
rm nginx/ssl/server.*
# –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç"
```

**2. 404 –Ω–∞ API endpoints:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
docker exec nginx-proxy nginx -t

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é
curl -k http://localhost:8080/api/health  # –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø
curl -k http://localhost:8081/api/health  # –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø
```

**3. FFmpeg –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker logs streaming-service --tail 50

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã SRT
netstat -tlnp | grep :10000

# –ü—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
ls -la /opt/streamapp/hls_output/
```

**4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å PostgreSQL
docker-compose logs postgres

# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
docker exec -it postgres-db psql -U postgres -c "SELECT 1;"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker-compose config
```


### **–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã:**

```bash
# –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
docker system df
docker system info

# –°–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
docker network ls
docker network inspect deployments_app-network

# –ü—Ä–æ—Ü–µ—Å—Å—ã –∏ —Ä–µ—Å—É—Ä—Å—ã
docker stats

# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
docker-compose ps
docker-compose top
docker-compose logs --tail 100
```


### **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤:**

```bash
# –ü–æ–ª–Ω—ã–π —Ä–µ—Å—Ç–∞—Ä—Ç —Å–∏—Å—Ç–µ–º—ã
docker-compose down
docker system prune -f
docker-compose up -d

# –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö (–û–°–¢–û–†–û–ñ–ù–û!)
docker-compose down -v
docker system prune -af --volumes
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–∑ –±–µ–∫–∞–ø–∞ –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ
```


